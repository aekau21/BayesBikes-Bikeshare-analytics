---
title: "Final Project Exploratory"
format: html
editor: visual
---

## Exploratory Analysis

```{r}
###Load Libraries
library(ggcorrplot)
library(ggplot2)
library(dplyr)
library(lubridate)
```

```{r}
###Load Dataset
head(bikes)
```

```{r}
# Convert 'date' to date format for time series analysis
bikes$date <- as.Date(bikes$date, format = "%Y-%m-%d")

# Plot trend of rides over time
ggplot(bikes, aes(x = date, y = rides)) +
  geom_line(color = "steelblue") +
  labs(title = "Trend of Rides Over Time", x = "Date", y = "Total Rides")
```

```{r}
ggplot(data = bikes, aes(x = date, y = rides, color = temp_actual, shape = weekend)) +
  geom_point()
```

```{r}
# Compute correlation matrix for selected columns
cor_matrix <- cor(bikes[, c("temp_actual", "temp_feel", "humidity", "windspeed", "rides")], use = "complete.obs")

# Plot correlation heatmap
ggcorrplot(cor_matrix, lab = TRUE, colors = c("red", "white", "blue"))
```

```{r}
# Load necessary libraries
library(ggplot2)
library(dplyr)

# Assuming the dataset is already loaded into a DataFrame named 'bikes'
# with columns 'humidity', 'windspeed', and 'rides'

# Remove any missing data to avoid issues with plotting
bikes <- na.omit(bikes)

# Create a bar plot to show the distribution of rides by humidity levels
bikes %>%
  ggplot(aes(x = factor(round(humidity, -1)), y = rides)) +
  geom_bar(stat = 'summary', fun = 'mean', fill = 'skyblue') +
  labs(
    title = 'Average Number of Rides by Humidity Levels',
    x = 'Humidity (%) (Grouped)',
    y = 'Average Number of Rides'
  ) +
  theme_minimal()

# Alternatively, create a scatter plot with trend lines
bikes %>%
  ggplot(aes(x = humidity, y = rides, color = windspeed)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = 'lm', se = FALSE, color = 'red') +
  labs(
    title = 'Scatter Plot of Rides vs. Humidity with Windspeed Indication',
    x = 'Humidity (%)',
    y = 'Number of Rides',
    color = 'Windspeed (m/s)'
  ) +
  theme_minimal()
```
